@{
    Layout = "_MainAppLayout";
    ViewData["Title"] = "Time Sheet";
}
@addTagHelper *, Syncfusion.EJ2
@using CloudVOffice.Core.Domain.Common;
@model CloudVOffice.Data.DTO.Projects.TimesheetReportModel;
<header class="main-heading">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xl-8 col-lg-8 col-md-8 col-sm-8">
                <div class="page-icon">
                    <i class="icon-laptop_windows"></i>
                </div>
                <div class="page-title">
                    <h5>Timesheet</h5>
                    <h6 class="sub-heading">  </h6>
                </div>
            </div>
            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4">
                <div class="right-actions">
                    <span class="last-login">  </span>
                </div>
            </div>
        </div>
    </div>
</header>
<div class="main-content">
    <div class="row gutters">
        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
            <div class="card">
                <div class="card-header">
                    <div class="row">
                        <div class="col-md-6">
                            Timesheet Effort
                        </div>

                      
                    </div>
                </div>
                <div class="card-body">
                    <form asp-route="Projects/Timesheet/TimesheetReport" method="post" autocomplete="off">
                  
                        <div class="card-body">
                            <div class="form-row">
                                <div class="form-group col-md-3">
                                 

                                    <label for="Month" class="form-label">Month &nbsp;<span style="color:red;"><b>*</b></span></label>
                                    <select asp-for="@Model.Month" class="form-control">
                                        <option>--Select Month--</option>
                                        <option value="1">January</option>
                                        <option value="2">February</option>
                                        <option value="3">March</option>
                                        <option value="4">April</option>
                                        <option value="5">May</option>
                                        <option value="6">June</option>
                                        <option value="7">July</option>
                                        <option value="8">August</option>
                                        <option value="9">September</option>
                                        <option value="10">October</option>
                                        <option value="11">November</option>
                                        <option value="12">December</option>
                                    </select>
                                   
                                    
                                </div>


                                <div class="form-group col-md-3">
                                      <label for="Year" class="form-label">Year &nbsp;<span style="color:red;"><b>*</b></span></label>

                                    <select asp-for="@Model.Year" class="form-control">
                                     
                                    </select>
                                   
                                </div>

                            </div>
                        </div>

                        <div class="card-body">

                            <div class="col-lg-2 col-md-2 col-sm-12">
                                <button type="submit" class="btn btn-primary">Submit</button>
                            </div>
                        </div>

                    </form>



                    <ejs-grid id="GridOverview" dataSource="((System.Data.DataTable)ViewBag.report)"
                              allowFiltering="true" allowSorting="true"
                              allowExcelExport="true" allowGrouping="true"
                              allowMultiSorting="true"
                              allowPdfExport="true"
                              height="600" rowHeight="38"
                              enableHover="false" enableHeaderFocus="true"
                               allowResizing="true"
                              autoFit="true"
                              enableVirtualization="true" allowSelection="true"
                              dataBound="dataBound"
                              toolbarClick="toolbarClick" toolbar="@(new List<string>() {"ExcelExport", "PdfExport", "CsvExport" ,"Search"})">
                        <e-grid-filtersettings type="Menu"></e-grid-filtersettings>
                        <e-grid-selectionsettings persistSelection="true" type="Multiple" checkboxOnly="true"></e-grid-selectionsettings>
                        
                    </ejs-grid>
                </div>
            </div>
        </div>
    </div>

</div>


<script>
    
function dataBound(args) {
        this.autoFitColumns();
 }
    getYears();
 function getYears(){
        const d = new Date();
        let year = d.getFullYear();
        var op='<option>--Select Year--</optio>';
        for (var y=2023;y<=year;y++)
        {
            op= op + "<option value='"+year+"'>" + year + "</option>"
        }
        $('#Year').html(op);
 }
    function toolbarClick(args) {
        var gridObj = document.getElementById("GridOverview").ej2_instances[0];
        if (args.item.id === 'GridOverview_pdfexport') {
            gridObj.pdfExport();
        }
        if (args.item.id === 'GridOverview_excelexport') {
            gridObj.excelExport();
        }
        if (args.item.id === 'GridOverview_csvexport') {
            gridObj.csvExport();
        }
    }
 


</script>